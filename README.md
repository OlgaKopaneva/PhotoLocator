# Проект_Команда №12. 
# «PhotoLocator: Ваш путеводитель по миру на кончиках пальцев»

---
## Оглавление
[1. Описание проекта](#1.-описание-проекта)<a name="test"></a> 

[2. Какой кейс решаем](https://github.com/    )

[3. Краткая информация о данных](https://github.com/   )

[4. Этапы работы над проектом](https://github.com/    )

[5. Результат](https://github.com/     )

[6. Планы развития проекта](https://github.com/    )

---

### Описание проекта
Проект «PhotoLocator» нацелен на решение двух задач, с которыми сталкивается каждый путешественник:
- быстро понять, что за объект я вижу (как называется, какова его история, стоит ли зайти внутрь)
- вспомнить достопримечательность на фотографии из отпуска в «один клик».

:arrow_up: [к оглавлению](#test)

---

### Какой кейс решаем

**В бизнес-терминах:**  
Нужно запустить сервис, который при помощи ML-моделей по фотографии пользователя выдает в чат-боте описание достопримечательности и рекомендации к ней. 

**Техническая постановка:**  
*На первом этапе* - решить задачу детектирования и распознавания достопримечательности на фото-изображении, поданном на вход пользователем, путем дообучения предобученной модели нейросети.  
*На втором этапе* – полученный ответ первого этапа посредством подключения к API LLM-модели подавать в качестве промпта LLM-модели; ответ модели выводить пользователю в чат-боте Telegram. 

**Метрика качества:**  
Accuracy модели распознавания >90%

**Пример результата работы сервиса:**
<p align="left">
  <img width="350" height="380" src="images\chat-bot.jpg">
</p>  

:arrow_up: [к оглавлению](https://github.com/     /Readme.md#Оглавление)

---

### Краткая информация о данных
Модель дообучена на данных датасета «The Oxford Buildings Dataset» (Oxford5k), содержащем фотографии 11 достопримечательностей Оксфордского университета *(здания колледжей: “All souls”, “Hertford”, “Keble”, “Magdalen”, “Balliol”, “Christ Church”, а также “Pitt Rivers Museum”, “Bodleian Libraries”, “Ashmolean Museum”, “Radcliffe Camera”, “Cornmarket Street”)*.  
По каждому объекту присутствуют фотографии разного качества (ok, good, junk and query). Суммарно 5063 изображений.

Ссылка на датасет: https://www.kaggle.com/datasets/vadimshabashov/oxford5k 

:arrow_up: [к оглавлению](https://github.com/     /Readme.md#Оглавление)

---

### Этапы работы над проектом

**Выбор модели:**  
За основу была взята модель ResNet50 (и ее pretrained веса - ResNet50_Weights, полученные на датасете ImageNet, содержащем более 1 млн. изображений и 1000 классов). ResNet50 основана на архитектуре «остаточных» сверточных нейронных сетей (Residual CNN), содержит 50 слоев. Выбор обусловлен высокими показателями модели для классификации изображений (Accuracy базовой модели – 95.4%). 

**Дообучение модели:**  
Модель дообучена на данных датасета «The Oxford Buildings Dataset» (описан выше) и в итоге содержит 11 классов.

*Функция потерь*: PyTorch CrossEntropyLoss  
*Оптимизатор*: Адаптивная оценка момента (Adam)  
*Число эпох*: 15

**Чат-бот с использованием ответов ChatGPT:**  
Запущен чат-бот, получающий описание для класса, определенного моделью на предыдущем шаге. Используемая библиотека - GPT4free (g4f). Подаваемый промпт для ответа: *«Ты гид по колледжам в Оксфорде, подробно рассказывающий о их истории и культуре, делая это увлекательно и информативно. Подробно расскажи о месте под названием {predicted_class}. Обязательно на русском»*


:arrow_up: [к оглавлению](https://github.com/     /Readme.md#Оглавление)

---

### Результат

**Показатели качества итоговой модели:**  
Эпоха 15/15  
Обучение - Loss: 0.0942, Accuracy: 0.9965  
Валидация - Loss: 0.1012, Accuracy: 1.0000
<p align="left">
  <img width="700" height="300" src="images\output.png">
</p> 
<p align="left">
  <img width="300" height="250" src="images\output2.png">
</p>  
<p align="left">
  <img width="700" height="250" src="images\output3.png">
</p> 
 


:arrow_up: [к оглавлению](https://github.com/      /Readme.md#Оглавление)

---

### Планы развития проекта
При наличии больших вычислительных мощностей и времени возможно было бы построить модель для полного списка мировых достопримечательностей, взяв за основу датасет Google Landmarks Dataset v2 (основан на более 5 млн. изображений достопримечательностей). Также рассматриваются варианты реализации проекта на базе иных архитектур.

**Команда проекта:**
- Казиев Владислав
- Гришин Егор
- Алексеев Арсалан
- Копанева Ольга
- Лапенков Егор

 


:arrow_up: [к оглавлению](https://github.com/   /Readme.md#Оглавление)
